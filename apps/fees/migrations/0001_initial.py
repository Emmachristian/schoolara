# Generated by Django 5.2 on 2025-12-30 10:47

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
import uuid
from decimal import Decimal
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ("academics", "0002_initial"),
        ("core", "0002_initial"),
        ("finance", "0001_initial"),
        ("students", "0001_initial"),
    ]

    operations = [
        migrations.CreateModel(
            name="DisplayGroup",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        max_length=100, unique=True, verbose_name="Display Group Name"
                    ),
                ),
                (
                    "description",
                    models.TextField(blank=True, verbose_name="Description"),
                ),
                (
                    "display_order",
                    models.PositiveIntegerField(
                        default=1,
                        help_text="Lower numbers appear first on invoices",
                        verbose_name="Display Order",
                    ),
                ),
                (
                    "color_code",
                    models.CharField(
                        default="#6f42c1",
                        help_text="Hex color code for display (e.g., #2E86AB)",
                        max_length=7,
                        verbose_name="Color Code",
                    ),
                ),
                (
                    "show_as_group",
                    models.BooleanField(
                        default=True,
                        help_text="If checked, items in this group are displayed together under the group header. If unchecked, items are shown individually without grouping.",
                        verbose_name="Show as Group",
                    ),
                ),
                (
                    "show_group_subtotal",
                    models.BooleanField(
                        default=True,
                        help_text="Show subtotal for this group (only applies when 'Show as Group' is checked)",
                        verbose_name="Show Group Subtotal",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True, default=True, verbose_name="Is Active"
                    ),
                ),
            ],
            options={
                "verbose_name": "Display Group",
                "verbose_name_plural": "Display Groups",
                "ordering": ["display_order", "name"],
            },
        ),
        migrations.CreateModel(
            name="FeeInvoice",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "invoice_number",
                    models.CharField(
                        db_index=True,
                        max_length=50,
                        unique=True,
                        verbose_name="Invoice Number",
                    ),
                ),
                (
                    "issue_date",
                    models.DateField(db_index=True, verbose_name="Issue Date"),
                ),
                ("due_date", models.DateField(db_index=True, verbose_name="Due Date")),
                (
                    "subtotal_amount",
                    models.DecimalField(
                        decimal_places=2, max_digits=12, verbose_name="Subtotal Amount"
                    ),
                ),
                (
                    "discount_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Discount Amount",
                    ),
                ),
                (
                    "scholarship_discount_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Scholarship Discount Amount",
                    ),
                ),
                (
                    "tax_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Tax Amount",
                    ),
                ),
                (
                    "total_amount",
                    models.DecimalField(
                        decimal_places=2, max_digits=12, verbose_name="Total Amount"
                    ),
                ),
                (
                    "paid_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Paid Amount",
                    ),
                ),
                (
                    "balance",
                    models.DecimalField(
                        decimal_places=2, max_digits=12, verbose_name="Balance"
                    ),
                ),
                (
                    "late_fee_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=10,
                        verbose_name="Late Fee Amount",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("DRAFT", "Draft"),
                            ("PENDING", "Pending Payment"),
                            ("PARTIALLY_PAID", "Partially Paid"),
                            ("PAID", "Paid in Full"),
                            ("OVERDUE", "Overdue"),
                            ("CANCELLED", "Cancelled"),
                            ("VOID", "Void"),
                            ("BAD_DEBT", "Bad Debt"),
                            ("WRITTEN_OFF", "Written Off"),
                            ("UNCOLLECTIBLE", "Uncollectible"),
                        ],
                        db_index=True,
                        default="PENDING",
                        max_length=15,
                        verbose_name="Status",
                    ),
                ),
                (
                    "is_break_payment",
                    models.BooleanField(
                        default=False,
                        help_text="Invoice generated during break period",
                        verbose_name="Break Period Invoice",
                    ),
                ),
                (
                    "has_scholarships_applied",
                    models.BooleanField(
                        default=False, verbose_name="Has Scholarships Applied"
                    ),
                ),
                (
                    "has_discounts_applied",
                    models.BooleanField(
                        default=False, verbose_name="Has Discounts Applied"
                    ),
                ),
                (
                    "auto_scholarships_applied",
                    models.BooleanField(
                        default=False, verbose_name="Auto Scholarships Applied"
                    ),
                ),
                (
                    "auto_discounts_applied",
                    models.BooleanField(
                        default=False, verbose_name="Auto Discounts Applied"
                    ),
                ),
                (
                    "payment_terms",
                    models.CharField(
                        blank=True, max_length=200, verbose_name="Payment Terms"
                    ),
                ),
                ("notes", models.TextField(blank=True, verbose_name="Notes")),
                (
                    "internal_notes",
                    models.TextField(blank=True, verbose_name="Internal Notes"),
                ),
                (
                    "academic_session",
                    models.ForeignKey(
                        help_text="Academic session this invoice covers (e.g., Term 1 2024)",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="fee_invoices",
                        to="academics.academicsession",
                        verbose_name="Academic Session",
                    ),
                ),
                (
                    "fiscal_period",
                    models.ForeignKey(
                        help_text="Fiscal period when this invoice was issued (for financial reporting)",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="invoices",
                        to="core.fiscalperiod",
                        verbose_name="Fiscal Period",
                    ),
                ),
                (
                    "journal_entry",
                    models.ForeignKey(
                        blank=True,
                        help_text="Journal entry created for this invoice",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="fee_invoices",
                        to="finance.journalentry",
                        verbose_name="Journal Entry",
                    ),
                ),
                (
                    "receivable_account",
                    models.ForeignKey(
                        blank=True,
                        help_text="Receivable account to debit (typically Accounts Receivable - Students)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="receivable_invoices",
                        to="finance.account",
                        verbose_name="Accounts Receivable Account",
                    ),
                ),
                (
                    "revenue_account",
                    models.ForeignKey(
                        blank=True,
                        help_text="Account to credit for this invoice (typically Student Fees Receivable)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="fee_invoices",
                        to="finance.account",
                        verbose_name="Revenue Account",
                    ),
                ),
                (
                    "student",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="fee_invoices",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
            ],
            options={
                "verbose_name": "Fee Invoice",
                "verbose_name_plural": "Fee Invoices",
                "ordering": ["-issue_date", "-created_at"],
            },
        ),
        migrations.CreateModel(
            name="FeesCategory",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        max_length=100, unique=True, verbose_name="Fee Name"
                    ),
                ),
                (
                    "code",
                    models.CharField(
                        db_index=True,
                        help_text="Unique code for this fee category (e.g., TUI001, BRD001)",
                        max_length=20,
                        unique=True,
                        verbose_name="Fee Code",
                    ),
                ),
                (
                    "description",
                    models.TextField(blank=True, verbose_name="Description"),
                ),
                (
                    "category_type",
                    models.CharField(
                        choices=[
                            ("TUITION", "Tuition Fee"),
                            ("BOARDING", "Boarding Fee"),
                            ("MEALS", "Meals Fee"),
                            ("LAUNDRY", "Laundry Fee"),
                            ("TRANSPORT", "Transport Fee"),
                            ("UNIFORM", "Uniform Fee"),
                            ("BOOKS", "Books & Materials"),
                            ("EXAM", "Examination Fee"),
                            ("SPORT", "Sports Fee"),
                            ("CLUB", "Club/Activity Fee"),
                            ("REGISTRATION", "Registration Fee"),
                            ("ADMISSION", "Admission Fee"),
                            ("DEVELOPMENT", "Development Levy"),
                            ("MEDICAL", "Medical Fee"),
                            ("INSURANCE", "Insurance Fee"),
                            ("LIBRARY", "Library Fee"),
                            ("TECHNOLOGY", "Technology Fee"),
                            ("LABORATORY", "Laboratory Fee"),
                            ("FIELD_TRIP", "Field Trip"),
                            ("GRADUATION", "Graduation Fee"),
                            ("LATE_PAYMENT", "Late Payment Fee"),
                            ("MISCELLANEOUS", "Miscellaneous"),
                            ("OTHER", "Other"),
                        ],
                        db_index=True,
                        default="OTHER",
                        help_text="Type of fee - used by system to identify specific fees",
                        max_length=20,
                        verbose_name="Category Type",
                    ),
                ),
                (
                    "is_recurring",
                    models.BooleanField(default=True, verbose_name="Recurring"),
                ),
                (
                    "frequency",
                    models.CharField(
                        choices=[
                            ("MONTHLY", "Monthly"),
                            ("TERMLY", "Per Term"),
                            ("YEARLY", "Yearly"),
                            ("ONE_TIME", "One Time"),
                            ("DAILY", "Daily"),
                            ("WEEKLY", "Weekly"),
                        ],
                        default="TERMLY",
                        max_length=20,
                        verbose_name="Frequency",
                    ),
                ),
                (
                    "applicability",
                    models.CharField(
                        choices=[
                            ("ALL", "All Students"),
                            ("DAY_SCHOLARS", "Day Scholars Only"),
                            ("BOARDERS", "Boarders Only"),
                            ("WEEKLY_BOARDERS", "Weekly Boarders Only"),
                            ("FULL_BOARDERS", "Full Boarders Only"),
                            ("FLEXI_BOARDERS", "Flexible Boarders Only"),
                            ("NEW_STUDENTS", "New Students Only"),
                            ("CONTINUING_STUDENTS", "Continuing Students Only"),
                            ("SCHOLARSHIP_STUDENTS", "Scholarship Students"),
                            ("OPTIONAL", "Optional/Elective"),
                        ],
                        default="ALL",
                        max_length=25,
                        verbose_name="Applicable To",
                    ),
                ),
                (
                    "display_order",
                    models.PositiveIntegerField(
                        default=1, verbose_name="Display Order"
                    ),
                ),
                (
                    "is_mandatory",
                    models.BooleanField(default=True, verbose_name="Mandatory"),
                ),
                (
                    "is_refundable",
                    models.BooleanField(default=True, verbose_name="Refundable"),
                ),
                (
                    "allows_partial_payment",
                    models.BooleanField(
                        default=True, verbose_name="Allows Partial Payment"
                    ),
                ),
                (
                    "is_taxable",
                    models.BooleanField(default=False, verbose_name="Taxable"),
                ),
                (
                    "default_tax_rate",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                        verbose_name="Default Tax Rate (%)",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True, default=True, verbose_name="Active"
                    ),
                ),
                (
                    "applicable_levels",
                    models.ManyToManyField(
                        blank=True,
                        help_text="If empty, applies to all levels",
                        to="academics.academiclevel",
                        verbose_name="Applicable Academic Levels",
                    ),
                ),
                (
                    "display_group",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        to="fees.displaygroup",
                        verbose_name="Display Group",
                    ),
                ),
            ],
            options={
                "verbose_name": "Fee Category",
                "verbose_name_plural": "Fee Categories",
                "ordering": ["display_order", "name"],
            },
        ),
        migrations.CreateModel(
            name="FeesDiscount",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                ("name", models.CharField(max_length=50, verbose_name="Discount Name")),
                (
                    "code",
                    models.CharField(
                        db_index=True,
                        max_length=20,
                        unique=True,
                        verbose_name="Discount Code",
                    ),
                ),
                (
                    "discount_type",
                    models.CharField(
                        choices=[
                            ("PERCENTAGE", "Percentage"),
                            ("FIXED", "Fixed Amount"),
                            ("WAIVER", "Complete Waiver"),
                        ],
                        max_length=10,
                        verbose_name="Discount Type",
                    ),
                ),
                (
                    "discount_value",
                    models.DecimalField(
                        decimal_places=2,
                        max_digits=10,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.00"))
                        ],
                        verbose_name="Discount Value",
                    ),
                ),
                (
                    "description",
                    models.TextField(blank=True, verbose_name="Description"),
                ),
                (
                    "eligibility_criteria",
                    models.CharField(
                        choices=[
                            ("MERIT", "Merit Based"),
                            ("NEED", "Need Based"),
                            ("STAFF_CHILD", "Staff Child"),
                            ("SIBLING", "Sibling Discount"),
                            ("EARLY_PAYMENT", "Early Payment"),
                            ("BULK_PAYMENT", "Bulk Payment"),
                            ("SCHOLARSHIP", "Scholarship"),
                            ("SPECIAL_CASE", "Special Case"),
                            ("ACADEMIC_EXCELLENCE", "Academic Excellence"),
                            ("SPORTS_ACHIEVEMENT", "Sports Achievement"),
                            ("FINANCIAL_HARDSHIP", "Financial Hardship"),
                            ("LOYALTY_DISCOUNT", "Loyalty Discount"),
                        ],
                        default="SPECIAL_CASE",
                        max_length=25,
                        verbose_name="Eligibility Criteria",
                    ),
                ),
                (
                    "eligibility_rules",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="JSON rules for complex eligibility checking",
                        verbose_name="Eligibility Rules",
                    ),
                ),
                ("start_date", models.DateField(verbose_name="Start Date")),
                ("end_date", models.DateField(verbose_name="End Date")),
                (
                    "max_usage_count",
                    models.PositiveIntegerField(
                        blank=True,
                        help_text="Leave empty for unlimited usage",
                        null=True,
                        verbose_name="Maximum Usage Count",
                    ),
                ),
                (
                    "current_usage_count",
                    models.PositiveIntegerField(
                        default=0, verbose_name="Current Usage Count"
                    ),
                ),
                (
                    "budget_limit",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum total amount that can be discounted",
                        max_digits=12,
                        null=True,
                        verbose_name="Budget Limit",
                    ),
                ),
                (
                    "current_budget_used",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Current Budget Used",
                    ),
                ),
                (
                    "auto_apply",
                    models.BooleanField(default=False, verbose_name="Auto Apply"),
                ),
                (
                    "requires_approval",
                    models.BooleanField(default=True, verbose_name="Requires Approval"),
                ),
                (
                    "priority",
                    models.PositiveIntegerField(
                        default=100,
                        help_text="Lower number = higher priority when multiple discounts apply",
                        verbose_name="Priority",
                    ),
                ),
                (
                    "can_combine_with_other_discounts",
                    models.BooleanField(
                        default=False, verbose_name="Can Combine with Other Discounts"
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True, default=True, verbose_name="Active"
                    ),
                ),
                (
                    "academic_session",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="fee_discounts",
                        to="academics.academicsession",
                        verbose_name="Academic Session",
                    ),
                ),
                (
                    "applicable_categories",
                    models.ManyToManyField(
                        blank=True,
                        related_name="applicable_discounts",
                        to="fees.feescategory",
                        verbose_name="Applicable Fee Categories",
                    ),
                ),
                (
                    "mutually_exclusive_discounts",
                    models.ManyToManyField(
                        blank=True,
                        help_text="Discounts that cannot be applied together with this one",
                        to="fees.feesdiscount",
                        verbose_name="Mutually Exclusive Discounts",
                    ),
                ),
            ],
            options={
                "verbose_name": "Fee Discount",
                "verbose_name_plural": "Fee Discounts",
                "ordering": ["priority", "name"],
            },
        ),
        migrations.CreateModel(
            name="FeeInvoiceItem",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "description",
                    models.CharField(
                        blank=True, max_length=255, verbose_name="Description"
                    ),
                ),
                (
                    "quantity",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("1.00"),
                        max_digits=8,
                        verbose_name="Quantity",
                    ),
                ),
                (
                    "unit_amount",
                    models.DecimalField(
                        decimal_places=2, max_digits=10, verbose_name="Unit Amount"
                    ),
                ),
                (
                    "amount",
                    models.DecimalField(
                        decimal_places=2, max_digits=10, verbose_name="Amount"
                    ),
                ),
                (
                    "tax_percentage",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=5,
                        verbose_name="Tax Percentage",
                    ),
                ),
                (
                    "tax_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=10,
                        verbose_name="Tax Amount",
                    ),
                ),
                (
                    "discount_percentage",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=5,
                        verbose_name="Discount Percentage",
                    ),
                ),
                (
                    "discount_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=10,
                        verbose_name="Regular Discount Amount",
                    ),
                ),
                (
                    "scholarship_discount_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=10,
                        verbose_name="Scholarship Discount Amount",
                    ),
                ),
                (
                    "total_discount_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=10,
                        verbose_name="Total Discount Amount",
                    ),
                ),
                (
                    "final_amount",
                    models.DecimalField(
                        decimal_places=2, max_digits=10, verbose_name="Final Amount"
                    ),
                ),
                (
                    "has_scholarship_discount",
                    models.BooleanField(
                        default=False, verbose_name="Has Scholarship Discount"
                    ),
                ),
                (
                    "has_regular_discount",
                    models.BooleanField(
                        default=False, verbose_name="Has Regular Discount"
                    ),
                ),
                (
                    "original_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=10,
                        null=True,
                        verbose_name="Original Amount",
                    ),
                ),
                (
                    "invoice",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="items",
                        to="fees.feeinvoice",
                        verbose_name="Invoice",
                    ),
                ),
                (
                    "fee_category",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        to="fees.feescategory",
                        verbose_name="Fee Category",
                    ),
                ),
                (
                    "applied_discount",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="applied_invoice_items",
                        to="fees.feesdiscount",
                        verbose_name="Applied Regular Discount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Fee Invoice Item",
                "verbose_name_plural": "Fee Invoice Items",
            },
        ),
        migrations.CreateModel(
            name="DiscountApplication",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "discount_amount",
                    models.DecimalField(
                        decimal_places=2, max_digits=12, verbose_name="Discount Amount"
                    ),
                ),
                (
                    "applied_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who applied this discount",
                        max_length=50,
                        null=True,
                        verbose_name="Applied By ID",
                    ),
                ),
                (
                    "application_date",
                    models.DateTimeField(
                        auto_now_add=True, verbose_name="Application Date"
                    ),
                ),
                (
                    "notes",
                    models.TextField(blank=True, verbose_name="Application Notes"),
                ),
                (
                    "student",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="discount_applications",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
                (
                    "invoice",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="discount_applications",
                        to="fees.feeinvoice",
                        verbose_name="Invoice",
                    ),
                ),
                (
                    "discount",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="applications",
                        to="fees.feesdiscount",
                        verbose_name="Discount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Discount Application",
                "verbose_name_plural": "Discount Applications",
                "ordering": ["-application_date"],
            },
        ),
        migrations.CreateModel(
            name="FeesStructure",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Name of this fee structure (e.g., 'Secondary Day Scholar Fees')",
                        max_length=100,
                        verbose_name="Structure Name",
                    ),
                ),
                (
                    "description",
                    models.TextField(blank=True, verbose_name="Description"),
                ),
                (
                    "structure_type",
                    models.CharField(
                        choices=[
                            ("STANDARD", "Standard Structure"),
                            ("DAY_SCHOLAR", "Day Scholar Structure"),
                            ("BOARDER", "Boarder Structure"),
                            ("WEEKLY_BOARDER", "Weekly Boarder Structure"),
                            ("FULL_BOARDER", "Full Boarder Structure"),
                            ("FLEXI_BOARDER", "Flexible Boarder Structure"),
                            ("SCHOLARSHIP", "Scholarship Structure"),
                            ("CUSTOM", "Custom Structure"),
                            ("STAFF_CHILD", "Staff Child Structure"),
                            ("SIBLING_DISCOUNT", "Sibling Discount Structure"),
                            ("NEED_BASED", "Need-Based Structure"),
                            ("MERIT_BASED", "Merit-Based Structure"),
                        ],
                        db_index=True,
                        default="STANDARD",
                        max_length=20,
                        verbose_name="Structure Type",
                    ),
                ),
                (
                    "boarding_type_filter",
                    models.CharField(
                        choices=[
                            ("ALL", "All Students"),
                            ("DAY_ONLY", "Day Scholars Only"),
                            ("BOARDER_ONLY", "Boarders Only"),
                            ("FULL_BOARDER", "Full Boarders Only"),
                            ("WEEKLY_BOARDER", "Weekly Boarders Only"),
                            ("FLEXI_BOARDER", "Flexible Boarders Only"),
                        ],
                        default="ALL",
                        help_text="Filter by student boarding status",
                        max_length=20,
                        verbose_name="Boarding Type Filter",
                    ),
                ),
                (
                    "student_type_filter",
                    models.CharField(
                        choices=[
                            ("ALL", "All Students"),
                            ("NEW_ONLY", "New Students Only"),
                            ("CONTINUING_ONLY", "Continuing Students Only"),
                            ("SCHOLARSHIP_ONLY", "Scholarship Students Only"),
                        ],
                        default="ALL",
                        help_text="Filter by student enrollment type",
                        max_length=20,
                        verbose_name="Student Type Filter",
                    ),
                ),
                (
                    "auto_apply_criteria",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="JSON criteria for automatic application of this structure",
                        verbose_name="Auto-Apply Criteria",
                    ),
                ),
                (
                    "payment_terms_days",
                    models.PositiveIntegerField(
                        default=30,
                        help_text="Number of days from invoice date for payment",
                        verbose_name="Payment Terms (Days)",
                    ),
                ),
                (
                    "charges_late_fee",
                    models.BooleanField(default=False, verbose_name="Charges Late Fee"),
                ),
                (
                    "late_fee_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=10,
                        verbose_name="Late Fee Amount",
                    ),
                ),
                (
                    "late_fee_percentage",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=5,
                        verbose_name="Late Fee Percentage",
                    ),
                ),
                (
                    "grace_period_days",
                    models.PositiveIntegerField(
                        default=7,
                        help_text="Days after due date before late fees apply",
                        verbose_name="Grace Period (Days)",
                    ),
                ),
                (
                    "priority",
                    models.PositiveIntegerField(
                        default=100,
                        help_text="Lower number = higher priority when multiple structures match a student",
                        verbose_name="Priority",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True, default=True, verbose_name="Active"
                    ),
                ),
                (
                    "effective_date",
                    models.DateField(
                        db_index=True,
                        default=django.utils.timezone.now,
                        verbose_name="Effective Date",
                    ),
                ),
                (
                    "expiry_date",
                    models.DateField(
                        blank=True, db_index=True, null=True, verbose_name="Expiry Date"
                    ),
                ),
                (
                    "academic_levels",
                    models.ManyToManyField(
                        help_text="Academic levels this structure applies to (e.g., Form 1, Form 2, Form 3)",
                        related_name="fee_structures",
                        to="academics.academiclevel",
                        verbose_name="Academic Levels",
                    ),
                ),
                (
                    "applicable_classes",
                    models.ManyToManyField(
                        blank=True,
                        help_text="Leave empty to apply to ALL classes in the selected academic levels",
                        to="academics.class",
                        verbose_name="Applicable Classes",
                    ),
                ),
                (
                    "applicable_sessions",
                    models.ManyToManyField(
                        help_text="Academic sessions where this fee structure applies",
                        to="academics.academicsession",
                        verbose_name="Applicable Academic Sessions",
                    ),
                ),
            ],
            options={
                "verbose_name": "Fee Structure",
                "verbose_name_plural": "Fee Structures",
                "ordering": ["structure_type", "priority", "name"],
            },
        ),
        migrations.AddField(
            model_name="feesdiscount",
            name="applicable_structures",
            field=models.ManyToManyField(
                blank=True,
                related_name="applicable_discounts",
                to="fees.feesstructure",
                verbose_name="Applicable Fee Structures",
            ),
        ),
        migrations.AddField(
            model_name="feeinvoice",
            name="fee_structure",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="invoices",
                to="fees.feesstructure",
                verbose_name="Fee Structure",
            ),
        ),
        migrations.CreateModel(
            name="FeesStructureItem",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "amount",
                    models.DecimalField(
                        decimal_places=2,
                        max_digits=10,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.00"))
                        ],
                        verbose_name="Amount",
                    ),
                ),
                (
                    "tax_percentage",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=5,
                        verbose_name="Tax Percentage",
                    ),
                ),
                (
                    "discount_percentage",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=5,
                        verbose_name="Discount Percentage",
                    ),
                ),
                (
                    "scholarship_eligible",
                    models.BooleanField(
                        default=True,
                        help_text="Whether this fee item is eligible for scholarship discounts",
                        verbose_name="Scholarship Eligible",
                    ),
                ),
                (
                    "max_scholarship_discount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum scholarship discount percentage for this item",
                        max_digits=5,
                        null=True,
                        verbose_name="Maximum Scholarship Discount",
                    ),
                ),
                (
                    "is_conditional",
                    models.BooleanField(default=False, verbose_name="Conditional"),
                ),
                (
                    "condition_description",
                    models.TextField(blank=True, verbose_name="Condition Description"),
                ),
                (
                    "condition_criteria",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="JSON criteria for when this item should be included",
                        verbose_name="Condition Criteria",
                    ),
                ),
                (
                    "is_payable_in_installments",
                    models.BooleanField(
                        default=False, verbose_name="Payable in Installments"
                    ),
                ),
                (
                    "number_of_installments",
                    models.PositiveIntegerField(
                        default=1, verbose_name="Number of Installments"
                    ),
                ),
                (
                    "fee_category",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        to="fees.feescategory",
                        verbose_name="Fee Category",
                    ),
                ),
                (
                    "fee_structure",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="items",
                        to="fees.feesstructure",
                        verbose_name="Fee Structure",
                    ),
                ),
            ],
            options={
                "verbose_name": "Fee Structure Item",
                "verbose_name_plural": "Fee Structure Items",
                "ordering": ["fee_structure", "fee_category"],
            },
        ),
        migrations.CreateModel(
            name="Payment",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "payment_number",
                    models.CharField(
                        db_index=True,
                        max_length=50,
                        unique=True,
                        verbose_name="Payment Number",
                    ),
                ),
                (
                    "amount",
                    models.DecimalField(
                        decimal_places=2,
                        max_digits=12,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                        verbose_name="Amount",
                    ),
                ),
                (
                    "amount_applied_to_invoice",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Amount Applied to Invoice",
                    ),
                ),
                (
                    "overpayment_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Overpayment Amount",
                    ),
                ),
                (
                    "payment_date",
                    models.DateField(db_index=True, verbose_name="Payment Date"),
                ),
                (
                    "reference_number",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        max_length=100,
                        verbose_name="Reference Number",
                    ),
                ),
                (
                    "transaction_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        max_length=100,
                        verbose_name="Transaction ID",
                    ),
                ),
                (
                    "bank_name",
                    models.CharField(
                        blank=True, max_length=100, verbose_name="Bank Name"
                    ),
                ),
                (
                    "account_number",
                    models.CharField(
                        blank=True, max_length=50, verbose_name="Account Number"
                    ),
                ),
                (
                    "cheque_number",
                    models.CharField(
                        blank=True, max_length=50, verbose_name="Cheque Number"
                    ),
                ),
                (
                    "cheque_date",
                    models.DateField(blank=True, null=True, verbose_name="Cheque Date"),
                ),
                (
                    "mobile_money_provider",
                    models.CharField(
                        blank=True, max_length=50, verbose_name="Mobile Money Provider"
                    ),
                ),
                (
                    "mobile_number",
                    models.CharField(
                        blank=True,
                        help_text="Mobile money account number used for the transaction",
                        max_length=20,
                        verbose_name="Mobile Money Number",
                    ),
                ),
                (
                    "paid_by_name",
                    models.CharField(
                        blank=True,
                        help_text="Name of the person who made the payment",
                        max_length=200,
                        null=True,
                        verbose_name="Paid By (Name)",
                    ),
                ),
                (
                    "paid_by_phone",
                    models.CharField(
                        blank=True,
                        help_text="Contact phone number of the person who made the payment",
                        max_length=20,
                        null=True,
                        verbose_name="Paid By (Phone)",
                    ),
                ),
                (
                    "paid_by_email",
                    models.EmailField(
                        blank=True,
                        help_text="Email address of the person who made the payment",
                        max_length=254,
                        null=True,
                        verbose_name="Paid By (Email)",
                    ),
                ),
                (
                    "paid_by_relationship",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("STUDENT", "Student (Self)"),
                            ("FATHER", "Father"),
                            ("MOTHER", "Mother"),
                            ("UNCLE", "Uncle"),
                            ("AUNT", "Aunt"),
                            ("BROTHER", "Brother"),
                            ("SISTER", "Sister"),
                            ("GUARDIAN", "Guardian"),
                            ("SPONSOR", "Sponsor"),
                            ("GRANDPARENT", "Grandparent"),
                            ("STEP_FATHER", "Step Father"),
                            ("STEP_MOTHER", "Step Mother"),
                            ("FOSTER_PARENT", "Foster Parent"),
                            ("OTHER", "Other"),
                        ],
                        help_text="Relationship of payer to the student",
                        max_length=50,
                        null=True,
                        verbose_name="Relationship to Student",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending"),
                            ("PROCESSING", "Processing"),
                            ("COMPLETED", "Completed"),
                            ("FAILED", "Failed"),
                            ("CANCELLED", "Cancelled"),
                            ("REFUNDED", "Refunded"),
                        ],
                        db_index=True,
                        default="COMPLETED",
                        max_length=12,
                        verbose_name="Payment Status",
                    ),
                ),
                (
                    "is_verified",
                    models.BooleanField(
                        db_index=True, default=False, verbose_name="Verified"
                    ),
                ),
                (
                    "verified_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who verified this payment",
                        max_length=50,
                        null=True,
                        verbose_name="Verified By ID",
                    ),
                ),
                (
                    "verification_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Verification Date"
                    ),
                ),
                (
                    "receipt_number",
                    models.CharField(
                        db_index=True,
                        max_length=50,
                        unique=True,
                        verbose_name="Receipt Number",
                    ),
                ),
                (
                    "receipt_issued",
                    models.BooleanField(default=False, verbose_name="Receipt Issued"),
                ),
                (
                    "receipt_issued_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Receipt Issued Date"
                    ),
                ),
                (
                    "received_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who received this payment",
                        max_length=50,
                        null=True,
                        verbose_name="Received By ID",
                    ),
                ),
                (
                    "processed_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who processed this payment",
                        max_length=50,
                        null=True,
                        verbose_name="Processed By ID",
                    ),
                ),
                ("remarks", models.TextField(blank=True, verbose_name="Remarks")),
                (
                    "internal_notes",
                    models.TextField(blank=True, verbose_name="Internal Notes"),
                ),
                (
                    "is_break_payment",
                    models.BooleanField(
                        default=False,
                        help_text="Payment made during break period",
                        verbose_name="Break Period Payment",
                    ),
                ),
                (
                    "fee_breakdown",
                    models.JSONField(
                        blank=True, default=dict, verbose_name="Fee Breakdown"
                    ),
                ),
                (
                    "academic_session",
                    models.ForeignKey(
                        help_text="Academic session this payment is for (from invoice)",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="payments",
                        to="academics.academicsession",
                        verbose_name="Academic Session",
                    ),
                ),
                (
                    "deposit_account",
                    models.ForeignKey(
                        help_text="Bank/Cash account where payment was deposited",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="fee_payments",
                        to="finance.account",
                        verbose_name="Deposit Account",
                    ),
                ),
                (
                    "fiscal_period",
                    models.ForeignKey(
                        help_text="Fiscal period when payment was received (for cash flow tracking)",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="payments",
                        to="core.fiscalperiod",
                        verbose_name="Fiscal Period",
                    ),
                ),
                (
                    "invoice",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="payments",
                        to="fees.feeinvoice",
                        verbose_name="Invoice",
                    ),
                ),
                (
                    "journal_entry",
                    models.ForeignKey(
                        blank=True,
                        help_text="Journal entry created for this payment",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="fee_payments",
                        to="finance.journalentry",
                        verbose_name="Journal Entry",
                    ),
                ),
                (
                    "payment_method",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="student_payments",
                        to="core.paymentmethod",
                        verbose_name="Payment Method",
                    ),
                ),
                (
                    "processing_fee_account",
                    models.ForeignKey(
                        blank=True,
                        help_text="Expense account for payment processing fees",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="processing_fee_payments",
                        to="finance.account",
                        verbose_name="Processing Fee Account",
                    ),
                ),
                (
                    "receivable_account",
                    models.ForeignKey(
                        blank=True,
                        help_text="Accounts Receivable account to credit (clears the receivable)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="cleared_payments",
                        to="finance.account",
                        verbose_name="Receivable Account",
                    ),
                ),
                (
                    "student",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="payments",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
            ],
            options={
                "verbose_name": "Payment",
                "verbose_name_plural": "Payments",
                "ordering": ["-payment_date", "-created_at"],
            },
        ),
        migrations.CreateModel(
            name="Refund",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "refund_number",
                    models.CharField(
                        db_index=True,
                        max_length=50,
                        unique=True,
                        verbose_name="Refund Number",
                    ),
                ),
                (
                    "refund_type",
                    models.CharField(
                        choices=[
                            ("OVERPAYMENT", "Overpayment Refund"),
                            ("WITHDRAWAL", "Withdrawal Refund"),
                            ("ERROR_CORRECTION", "Error Correction"),
                            ("POLICY_REFUND", "Policy Refund"),
                            ("GOODWILL", "Goodwill Refund"),
                        ],
                        default="OVERPAYMENT",
                        max_length=20,
                        verbose_name="Refund Type",
                    ),
                ),
                (
                    "amount",
                    models.DecimalField(
                        decimal_places=2,
                        max_digits=12,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                        verbose_name="Amount",
                    ),
                ),
                ("reason", models.TextField(verbose_name="Reason")),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("REQUESTED", "Requested"),
                            ("UNDER_REVIEW", "Under Review"),
                            ("APPROVED", "Approved"),
                            ("REJECTED", "Rejected"),
                            ("PROCESSING", "Processing"),
                            ("COMPLETED", "Completed"),
                            ("CANCELLED", "Cancelled"),
                        ],
                        db_index=True,
                        default="REQUESTED",
                        max_length=15,
                        verbose_name="Status",
                    ),
                ),
                (
                    "requested_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who requested this refund",
                        max_length=50,
                        null=True,
                        verbose_name="Requested By ID",
                    ),
                ),
                (
                    "requested_date",
                    models.DateField(auto_now_add=True, verbose_name="Requested Date"),
                ),
                (
                    "reviewed_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who reviewed this refund",
                        max_length=50,
                        null=True,
                        verbose_name="Reviewed By ID",
                    ),
                ),
                (
                    "review_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Review Date"
                    ),
                ),
                (
                    "review_notes",
                    models.TextField(blank=True, verbose_name="Review Notes"),
                ),
                (
                    "approved_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who approved this refund",
                        max_length=50,
                        null=True,
                        verbose_name="Approved By ID",
                    ),
                ),
                (
                    "approval_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Approval Date"
                    ),
                ),
                (
                    "approved_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=12,
                        null=True,
                        verbose_name="Approved Amount",
                    ),
                ),
                (
                    "payment_date",
                    models.DateField(
                        blank=True, null=True, verbose_name="Payment Date"
                    ),
                ),
                (
                    "transaction_id",
                    models.CharField(
                        blank=True, max_length=100, verbose_name="Transaction ID"
                    ),
                ),
                (
                    "bank_details",
                    models.JSONField(
                        blank=True, default=dict, verbose_name="Bank Details"
                    ),
                ),
                (
                    "supporting_documents",
                    models.TextField(blank=True, verbose_name="Supporting Documents"),
                ),
                (
                    "internal_notes",
                    models.TextField(blank=True, verbose_name="Internal Notes"),
                ),
                (
                    "academic_session",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="refunds",
                        to="academics.academicsession",
                        verbose_name="Academic Session",
                    ),
                ),
                (
                    "fiscal_period",
                    models.ForeignKey(
                        blank=True,
                        help_text="Fiscal period when refund was processed",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="refunds",
                        to="core.fiscalperiod",
                        verbose_name="Fiscal Period",
                    ),
                ),
                (
                    "invoice",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="refunds",
                        to="fees.feeinvoice",
                        verbose_name="Related Invoice",
                    ),
                ),
                (
                    "payment",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="refunds",
                        to="fees.payment",
                        verbose_name="Related Payment",
                    ),
                ),
                (
                    "payment_method",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="student_refunds",
                        to="core.paymentmethod",
                        verbose_name="Payment Method",
                    ),
                ),
                (
                    "receivable_account",
                    models.ForeignKey(
                        blank=True,
                        help_text="Accounts Receivable account to debit (if refunding an overpayment)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="refunded_receivables",
                        to="finance.account",
                        verbose_name="Receivable Account",
                    ),
                ),
                (
                    "refund_account",
                    models.ForeignKey(
                        help_text="Cash/Bank account from which refund is paid",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="fee_refunds",
                        to="finance.account",
                        verbose_name="Refund Account",
                    ),
                ),
                (
                    "revenue_reversal_account",
                    models.ForeignKey(
                        blank=True,
                        help_text="Revenue account to debit (if reversing revenue)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="reversed_revenue",
                        to="finance.account",
                        verbose_name="Revenue Reversal Account",
                    ),
                ),
                (
                    "student",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="refunds",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
            ],
            options={
                "verbose_name": "Refund",
                "verbose_name_plural": "Refunds",
                "ordering": ["-requested_date"],
            },
        ),
        migrations.CreateModel(
            name="ScholarshipProgram",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                ("name", models.CharField(max_length=200, verbose_name="Program Name")),
                (
                    "code",
                    models.CharField(
                        db_index=True,
                        max_length=50,
                        unique=True,
                        verbose_name="Program Code",
                    ),
                ),
                (
                    "scholarship_type",
                    models.CharField(
                        choices=[
                            ("ACADEMIC_MERIT", "Academic Merit"),
                            ("SPORTS_EXCELLENCE", "Sports Excellence"),
                            ("ARTS_TALENT", "Arts & Talent"),
                            ("NEED_BASED", "Need-Based"),
                            ("STAFF_CHILD", "Staff Child"),
                            ("SIBLING_DISCOUNT", "Sibling Discount"),
                            ("MULTIPLE_SIBLING", "Multiple Sibling Discount"),
                            ("COMMUNITY_SERVICE", "Community Service"),
                            ("LEADERSHIP", "Leadership Excellence"),
                            ("SPECIAL_CIRCUMSTANCES", "Special Circumstances"),
                            ("ALUMNI_SPONSORED", "Alumni Sponsored"),
                            ("CORPORATE_SPONSORED", "Corporate Sponsored"),
                            ("GOVERNMENT_BURSARY", "Government Bursary"),
                            ("FULL_SCHOLARSHIP", "Full Scholarship"),
                            ("PARTIAL_SCHOLARSHIP", "Partial Scholarship"),
                            ("EMERGENCY_AID", "Emergency Financial Aid"),
                        ],
                        db_index=True,
                        max_length=30,
                        verbose_name="Scholarship Type",
                    ),
                ),
                ("description", models.TextField(verbose_name="Description")),
                (
                    "discount_type",
                    models.CharField(
                        choices=[
                            ("PERCENTAGE", "Percentage Discount"),
                            ("FIXED_AMOUNT", "Fixed Amount Discount"),
                            ("FULL_WAIVER", "Full Fee Waiver"),
                            ("CATEGORY_SPECIFIC", "Specific Fee Categories Only"),
                        ],
                        max_length=20,
                        verbose_name="Discount Type",
                    ),
                ),
                (
                    "discount_percentage",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=5,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                        verbose_name="Discount Percentage",
                    ),
                ),
                (
                    "fixed_discount_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=12,
                        null=True,
                        verbose_name="Fixed Discount Amount",
                    ),
                ),
                (
                    "maximum_award_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=12,
                        null=True,
                        verbose_name="Maximum Award Amount Per Student",
                    ),
                ),
                (
                    "minimum_gpa",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=4,
                        null=True,
                        verbose_name="Minimum GPA Requirement",
                    ),
                ),
                (
                    "minimum_attendance_percentage",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=5,
                        null=True,
                        verbose_name="Minimum Attendance Percentage",
                    ),
                ),
                (
                    "family_income_threshold",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum family income for need-based scholarships",
                        max_digits=15,
                        null=True,
                        verbose_name="Family Income Threshold",
                    ),
                ),
                (
                    "total_budget_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=15,
                        null=True,
                        verbose_name="Total Program Budget",
                    ),
                ),
                (
                    "maximum_recipients",
                    models.PositiveIntegerField(
                        blank=True,
                        null=True,
                        verbose_name="Maximum Number of Recipients",
                    ),
                ),
                (
                    "current_budget_used",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=15,
                        verbose_name="Current Budget Used",
                    ),
                ),
                (
                    "current_recipient_count",
                    models.PositiveIntegerField(
                        default=0, verbose_name="Current Recipients"
                    ),
                ),
                (
                    "renewal_policy",
                    models.CharField(
                        choices=[
                            ("AUTOMATIC", "Automatic Renewal"),
                            ("PERFORMANCE_BASED", "Performance-Based Review"),
                            ("ANNUAL_APPLICATION", "Annual Re-application Required"),
                            ("ONE_TIME_ONLY", "One-Time Award"),
                        ],
                        default="ANNUAL_APPLICATION",
                        max_length=20,
                        verbose_name="Renewal Policy",
                    ),
                ),
                (
                    "maximum_duration_years",
                    models.PositiveIntegerField(
                        default=1,
                        help_text="Maximum years a student can receive this scholarship",
                        verbose_name="Maximum Duration (Years)",
                    ),
                ),
                (
                    "application_start_date",
                    models.DateField(
                        blank=True, null=True, verbose_name="Application Start Date"
                    ),
                ),
                (
                    "application_end_date",
                    models.DateField(
                        blank=True, null=True, verbose_name="Application End Date"
                    ),
                ),
                (
                    "award_announcement_date",
                    models.DateField(
                        blank=True, null=True, verbose_name="Award Announcement Date"
                    ),
                ),
                (
                    "sponsor_name",
                    models.CharField(
                        blank=True, max_length=200, verbose_name="Sponsor Name"
                    ),
                ),
                (
                    "sponsor_contact",
                    models.TextField(
                        blank=True, verbose_name="Sponsor Contact Information"
                    ),
                ),
                (
                    "external_funding_source",
                    models.CharField(
                        blank=True,
                        max_length=200,
                        verbose_name="External Funding Source",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True, default=True, verbose_name="Is Active"
                    ),
                ),
                (
                    "is_accepting_applications",
                    models.BooleanField(
                        default=True, verbose_name="Accepting Applications"
                    ),
                ),
                (
                    "applicable_fee_categories",
                    models.ManyToManyField(
                        blank=True,
                        help_text="Leave empty to apply to all fee categories",
                        to="fees.feescategory",
                        verbose_name="Applicable Fee Categories",
                    ),
                ),
                (
                    "applicable_levels",
                    models.ManyToManyField(
                        blank=True,
                        help_text="Leave empty to apply to all levels",
                        to="academics.academiclevel",
                        verbose_name="Applicable Academic Levels",
                    ),
                ),
                (
                    "valid_sessions",
                    models.ManyToManyField(
                        blank=True,
                        help_text="Sessions in which this program is available",
                        to="academics.academicsession",
                        verbose_name="Valid Academic Sessions",
                    ),
                ),
            ],
            options={
                "verbose_name": "Scholarship Program",
                "verbose_name_plural": "Scholarship Programs",
                "ordering": ["name"],
            },
        ),
        migrations.CreateModel(
            name="StudentAccount",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "current_balance",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Positive = Credit (overpayment), Negative = Debit (outstanding)",
                        max_digits=12,
                        verbose_name="Current Balance",
                    ),
                ),
                (
                    "total_fees_charged",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Total Fees Charged",
                    ),
                ),
                (
                    "total_payments_received",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Total Payments Received",
                    ),
                ),
                (
                    "total_discounts_applied",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Total Discounts Applied",
                    ),
                ),
                (
                    "total_refunds_issued",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        max_digits=12,
                        verbose_name="Total Refunds Issued",
                    ),
                ),
                (
                    "credit_limit",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Maximum negative balance allowed",
                        max_digits=10,
                        verbose_name="Credit Limit",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("ACTIVE", "Active"),
                            ("SUSPENDED", "Suspended"),
                            ("FROZEN", "Frozen"),
                            ("CLOSED", "Closed"),
                        ],
                        db_index=True,
                        default="ACTIVE",
                        max_length=10,
                        verbose_name="Account Status",
                    ),
                ),
                (
                    "last_transaction_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Last Transaction Date"
                    ),
                ),
                (
                    "last_payment_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Last Payment Date"
                    ),
                ),
                (
                    "student",
                    models.OneToOneField(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="financial_account",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
            ],
            options={
                "verbose_name": "Student Account",
                "verbose_name_plural": "Student Accounts",
            },
        ),
        migrations.CreateModel(
            name="AccountTransaction",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "transaction_type",
                    models.CharField(
                        choices=[
                            ("CREDIT", "Credit"),
                            ("DEBIT", "Debit"),
                            ("PAYMENT", "Payment"),
                            ("INVOICE", "Invoice"),
                            ("DISCOUNT", "Discount"),
                            ("REFUND", "Refund"),
                            ("ADJUSTMENT", "Adjustment"),
                            ("TRANSFER", "Transfer"),
                        ],
                        db_index=True,
                        max_length=15,
                        verbose_name="Transaction Type",
                    ),
                ),
                (
                    "amount",
                    models.DecimalField(
                        decimal_places=2, max_digits=12, verbose_name="Amount"
                    ),
                ),
                ("description", models.TextField(verbose_name="Description")),
                (
                    "balance_after",
                    models.DecimalField(
                        decimal_places=2,
                        max_digits=12,
                        verbose_name="Balance After Transaction",
                    ),
                ),
                (
                    "reference_number",
                    models.CharField(
                        blank=True, max_length=50, verbose_name="Reference Number"
                    ),
                ),
                (
                    "processed_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who processed this transaction",
                        max_length=50,
                        null=True,
                        verbose_name="Processed By ID",
                    ),
                ),
                (
                    "academic_session",
                    models.ForeignKey(
                        blank=True,
                        help_text="Academic session this transaction relates to",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="account_transactions",
                        to="academics.academicsession",
                        verbose_name="Academic Session",
                    ),
                ),
                (
                    "fiscal_period",
                    models.ForeignKey(
                        blank=True,
                        help_text="Fiscal period when this transaction was recorded",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="account_transactions",
                        to="core.fiscalperiod",
                        verbose_name="Fiscal Period",
                    ),
                ),
                (
                    "invoice",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        to="fees.feeinvoice",
                        verbose_name="Related Invoice",
                    ),
                ),
                (
                    "payment",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        to="fees.payment",
                        verbose_name="Related Payment",
                    ),
                ),
                (
                    "student_account",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="transactions",
                        to="fees.studentaccount",
                        verbose_name="Student Account",
                    ),
                ),
            ],
            options={
                "verbose_name": "Account Transaction",
                "verbose_name_plural": "Account Transactions",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="StudentScholarship",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "amount_awarded",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Total scholarship amount available across all sessions",
                        max_digits=12,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                        verbose_name="Total Amount Awarded",
                    ),
                ),
                (
                    "total_amount_used",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Cumulative amount applied to invoices",
                        max_digits=12,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.00"))
                        ],
                        verbose_name="Total Amount Used to Date",
                    ),
                ),
                (
                    "start_date",
                    models.DateField(
                        help_text="Scholarship becomes active from this date",
                        verbose_name="Start Date",
                    ),
                ),
                (
                    "end_date",
                    models.DateField(
                        blank=True,
                        help_text="Scholarship ends on this date (leave blank for no end date)",
                        null=True,
                        verbose_name="End Date",
                    ),
                ),
                (
                    "distribution_method",
                    models.CharField(
                        choices=[
                            ("UNTIL_EXHAUSTED", "Apply Until Exhausted"),
                            ("EQUAL_PER_SESSION", "Equal Amount Per Academic Session"),
                            ("EQUAL_PER_INVOICE", "Equal Amount Per Invoice"),
                            ("PROPORTIONAL", "Proportional to Invoice Amount"),
                            ("MANUAL", "Manual Allocation Per Session"),
                        ],
                        default="EQUAL_PER_SESSION",
                        help_text="How to distribute the scholarship across multiple sessions/invoices",
                        max_length=20,
                        verbose_name="Distribution Method",
                    ),
                ),
                (
                    "amount_per_session",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="For EQUAL_PER_SESSION: fixed amount to apply per academic session",
                        max_digits=12,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                        verbose_name="Amount Per Session",
                    ),
                ),
                (
                    "amount_per_invoice",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="For EQUAL_PER_INVOICE: fixed amount to apply per invoice",
                        max_digits=12,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                        verbose_name="Amount Per Invoice",
                    ),
                ),
                (
                    "max_amount_per_session",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Cap on total amount that can be applied to a single session",
                        max_digits=12,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                        verbose_name="Maximum Amount Per Session",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("ACTIVE", "Active"),
                            ("SUSPENDED", "Suspended"),
                            ("TERMINATED", "Terminated"),
                            ("COMPLETED", "Completed"),
                            ("PENDING", "Pending Activation"),
                        ],
                        db_index=True,
                        default="ACTIVE",
                        max_length=15,
                        verbose_name="Scholarship Status",
                    ),
                ),
                (
                    "is_renewable",
                    models.BooleanField(
                        default=True,
                        help_text="Can this scholarship be renewed for multiple years/sessions?",
                        verbose_name="Is Renewable",
                    ),
                ),
                (
                    "requires_renewal_verification",
                    models.BooleanField(
                        default=True,
                        help_text="Check eligibility criteria before each disbursement?",
                        verbose_name="Requires Renewal Verification",
                    ),
                ),
                (
                    "renewal_criteria",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Criteria student must meet for renewal",
                        verbose_name="Renewal Criteria",
                    ),
                ),
                (
                    "next_renewal_check_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when next renewal verification is due",
                        null=True,
                        verbose_name="Next Renewal Check Date",
                    ),
                ),
                (
                    "times_renewed",
                    models.PositiveIntegerField(
                        default=0,
                        help_text="Number of times this scholarship has been renewed",
                        verbose_name="Times Renewed",
                    ),
                ),
                (
                    "last_renewal_date",
                    models.DateField(
                        blank=True,
                        help_text="Date of most recent renewal",
                        null=True,
                        verbose_name="Last Renewal Date",
                    ),
                ),
                (
                    "current_gpa",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Student's current GPA (for renewal verification)",
                        max_digits=4,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.00")),
                            django.core.validators.MaxValueValidator(Decimal("4.00")),
                        ],
                        verbose_name="Current GPA",
                    ),
                ),
                (
                    "current_attendance",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Student's current attendance percentage",
                        max_digits=5,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.00")),
                            django.core.validators.MaxValueValidator(Decimal("100.00")),
                        ],
                        verbose_name="Current Attendance %",
                    ),
                ),
                (
                    "performance_notes",
                    models.TextField(
                        blank=True,
                        help_text="Notes on student's academic performance",
                        verbose_name="Performance Notes",
                    ),
                ),
                (
                    "awarded_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who approved this scholarship",
                        max_length=50,
                        null=True,
                        verbose_name="Awarded By ID",
                    ),
                ),
                (
                    "awarded_date",
                    models.DateField(
                        default=django.utils.timezone.now,
                        help_text="Date when scholarship was officially awarded",
                        verbose_name="Date Awarded",
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True,
                        help_text="Internal notes about this scholarship",
                        verbose_name="Administrative Notes",
                    ),
                ),
                (
                    "suspension_reason",
                    models.TextField(
                        blank=True,
                        help_text="Reason for suspension (if status is SUSPENDED)",
                        verbose_name="Suspension Reason",
                    ),
                ),
                (
                    "termination_reason",
                    models.TextField(
                        blank=True,
                        help_text="Reason for termination (if status is TERMINATED)",
                        verbose_name="Termination Reason",
                    ),
                ),
                (
                    "scholarship_program",
                    models.ForeignKey(
                        help_text="Program under which this scholarship is awarded",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="student_scholarships",
                        to="fees.scholarshipprogram",
                        verbose_name="Scholarship Program",
                    ),
                ),
                (
                    "student",
                    models.ForeignKey(
                        help_text="Student receiving this scholarship",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="scholarships",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
            ],
            options={
                "verbose_name": "Student Scholarship",
                "verbose_name_plural": "Student Scholarships",
                "ordering": ["-awarded_date"],
            },
        ),
        migrations.CreateModel(
            name="ScholarshipApplicationLog",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "amount_applied",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Amount of scholarship applied to this invoice",
                        max_digits=12,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                        verbose_name="Amount Applied",
                    ),
                ),
                (
                    "remaining_balance_after",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Scholarship balance remaining after this application",
                        max_digits=12,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.00"))
                        ],
                        verbose_name="Remaining Balance After Application",
                    ),
                ),
                (
                    "application_date",
                    models.DateField(
                        help_text="Date when scholarship was applied to invoice",
                        verbose_name="Application Date",
                    ),
                ),
                (
                    "distribution_method_used",
                    models.CharField(
                        blank=True,
                        help_text="Which distribution method was used for this application",
                        max_length=20,
                        verbose_name="Distribution Method Used",
                    ),
                ),
                (
                    "applied_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who applied the scholarship (if manual)",
                        max_length=50,
                        null=True,
                        verbose_name="Applied By ID",
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True,
                        help_text="Additional notes about this application",
                        verbose_name="Notes",
                    ),
                ),
                (
                    "is_reversed",
                    models.BooleanField(
                        default=False,
                        help_text="Has this application been reversed/undone?",
                        verbose_name="Is Reversed",
                    ),
                ),
                (
                    "reversed_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when this application was reversed",
                        null=True,
                        verbose_name="Reversed Date",
                    ),
                ),
                (
                    "reversed_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who reversed this application",
                        max_length=50,
                        null=True,
                        verbose_name="Reversed By ID",
                    ),
                ),
                (
                    "reversal_reason",
                    models.TextField(
                        blank=True,
                        help_text="Reason for reversing this application",
                        verbose_name="Reversal Reason",
                    ),
                ),
                (
                    "academic_session",
                    models.ForeignKey(
                        blank=True,
                        help_text="Academic session for this application",
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="scholarship_application_logs",
                        to="academics.academicsession",
                        verbose_name="Academic Session",
                    ),
                ),
                (
                    "invoice",
                    models.ForeignKey(
                        help_text="Invoice to which scholarship was applied",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="scholarship_application_logs",
                        to="fees.feeinvoice",
                        verbose_name="Invoice",
                    ),
                ),
                (
                    "student",
                    models.ForeignKey(
                        help_text="Student who received the scholarship",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="scholarship_application_logs",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
                (
                    "scholarship",
                    models.ForeignKey(
                        help_text="Scholarship that was applied",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="application_logs",
                        to="fees.studentscholarship",
                        verbose_name="Scholarship",
                    ),
                ),
            ],
            options={
                "verbose_name": "Scholarship Application Log",
                "verbose_name_plural": "Scholarship Application Logs",
                "ordering": ["-application_date", "-created_at"],
            },
        ),
        migrations.CreateModel(
            name="StudentScholarshipApplication",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was created (in school's operational timezone)",
                        verbose_name="Created At",
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this record was last updated (in school's operational timezone)",
                        verbose_name="Updated At",
                    ),
                ),
                (
                    "created_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who created this record",
                        max_length=50,
                        null=True,
                        verbose_name="Created By ID",
                    ),
                ),
                (
                    "updated_by_id",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="ID of user who last updated this record",
                        max_length=50,
                        null=True,
                        verbose_name="Updated By ID",
                    ),
                ),
                (
                    "created_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was created",
                        null=True,
                        verbose_name="Created From IP",
                    ),
                ),
                (
                    "updated_from_ip",
                    models.GenericIPAddressField(
                        blank=True,
                        help_text="IP address from which this record was last updated",
                        null=True,
                        verbose_name="Updated From IP",
                    ),
                ),
                (
                    "change_reason",
                    models.CharField(
                        blank=True,
                        help_text="Explanation for why this change was made",
                        max_length=255,
                        null=True,
                        verbose_name="Change Reason",
                    ),
                ),
                (
                    "application_number",
                    models.CharField(
                        db_index=True,
                        max_length=50,
                        unique=True,
                        verbose_name="Application Number",
                    ),
                ),
                (
                    "application_date",
                    models.DateField(
                        auto_now_add=True, verbose_name="Application Date"
                    ),
                ),
                (
                    "requested_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=12,
                        null=True,
                        verbose_name="Requested Amount",
                    ),
                ),
                ("essay", models.TextField(blank=True, verbose_name="Personal Essay")),
                (
                    "family_income",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=12,
                        null=True,
                        verbose_name="Family Monthly Income",
                    ),
                ),
                (
                    "number_of_dependents",
                    models.PositiveIntegerField(
                        blank=True, null=True, verbose_name="Number of Dependents"
                    ),
                ),
                (
                    "special_circumstances",
                    models.TextField(blank=True, verbose_name="Special Circumstances"),
                ),
                (
                    "current_gpa",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=4,
                        null=True,
                        verbose_name="Current GPA",
                    ),
                ),
                (
                    "attendance_percentage",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=5,
                        null=True,
                        verbose_name="Attendance Percentage",
                    ),
                ),
                (
                    "supporting_documents",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of uploaded document references",
                        verbose_name="Supporting Documents",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("DRAFT", "Draft"),
                            ("SUBMITTED", "Submitted"),
                            ("UNDER_REVIEW", "Under Review"),
                            ("APPROVED", "Approved"),
                            ("REJECTED", "Rejected"),
                            ("WAITLISTED", "Waitlisted"),
                            ("WITHDRAWN", "Withdrawn"),
                        ],
                        db_index=True,
                        default="SUBMITTED",
                        max_length=15,
                        verbose_name="Application Status",
                    ),
                ),
                (
                    "reviewed_by_id",
                    models.CharField(
                        blank=True,
                        help_text="User ID who reviewed this application",
                        max_length=50,
                        null=True,
                        verbose_name="Reviewed By ID",
                    ),
                ),
                (
                    "review_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Review Date"
                    ),
                ),
                (
                    "review_notes",
                    models.TextField(blank=True, verbose_name="Review Notes"),
                ),
                (
                    "approved_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=12,
                        null=True,
                        verbose_name="Approved Amount",
                    ),
                ),
                (
                    "decision_reason",
                    models.TextField(blank=True, verbose_name="Decision Reason"),
                ),
                (
                    "academic_session",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="scholarship_application_records",
                        to="academics.academicsession",
                        verbose_name="Academic Session",
                    ),
                ),
                (
                    "scholarship_program",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="applications",
                        to="fees.scholarshipprogram",
                        verbose_name="Scholarship Program",
                    ),
                ),
                (
                    "student",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="scholarship_applications",
                        to="students.student",
                        verbose_name="Student",
                    ),
                ),
            ],
            options={
                "verbose_name": "Scholarship Application",
                "verbose_name_plural": "Scholarship Applications",
                "ordering": ["-application_date"],
            },
        ),
        migrations.AddField(
            model_name="studentscholarship",
            name="application",
            field=models.OneToOneField(
                blank=True,
                help_text="Original application that led to this award",
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="awarded_scholarship",
                to="fees.studentscholarshipapplication",
                verbose_name="Related Application",
            ),
        ),
        migrations.AddIndex(
            model_name="feescategory",
            index=models.Index(fields=["code"], name="fees_feesca_code_a3c50c_idx"),
        ),
        migrations.AddIndex(
            model_name="feescategory",
            index=models.Index(
                fields=["category_type"], name="fees_feesca_categor_7e2f7d_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feescategory",
            index=models.Index(
                fields=["is_active"], name="fees_feesca_is_acti_6d1b80_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feescategory",
            index=models.Index(
                fields=["applicability"], name="fees_feesca_applica_8f8a75_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoiceitem",
            index=models.Index(
                fields=["invoice", "fee_category"],
                name="fees_feeinv_invoice_b9d1a8_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoiceitem",
            index=models.Index(
                fields=["has_scholarship_discount"],
                name="fees_feeinv_has_sch_40d4a7_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoiceitem",
            index=models.Index(
                fields=["has_regular_discount"], name="fees_feeinv_has_reg_49cc0b_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="discountapplication",
            index=models.Index(
                fields=["discount", "invoice"], name="fees_discou_discoun_539274_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="discountapplication",
            index=models.Index(
                fields=["student", "application_date"],
                name="fees_discou_student_47c708_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="feesstructure",
            index=models.Index(
                fields=["structure_type", "is_active"],
                name="fees_feesst_structu_ce2ef9_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="feesstructure",
            index=models.Index(
                fields=["boarding_type_filter"], name="fees_feesst_boardin_448aea_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feesstructure",
            index=models.Index(
                fields=["student_type_filter"], name="fees_feesst_student_6e852c_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feesstructure",
            index=models.Index(
                fields=["priority"], name="fees_feesst_priorit_597b0c_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feesstructure",
            index=models.Index(
                fields=["effective_date", "expiry_date"],
                name="fees_feesst_effecti_9cb4f1_idx",
            ),
        ),
        migrations.AlterUniqueTogether(
            name="feesstructure",
            unique_together={("name", "structure_type", "boarding_type_filter")},
        ),
        migrations.AddIndex(
            model_name="feesdiscount",
            index=models.Index(fields=["code"], name="fees_feesdi_code_633228_idx"),
        ),
        migrations.AddIndex(
            model_name="feesdiscount",
            index=models.Index(
                fields=["is_active"], name="fees_feesdi_is_acti_3f65ca_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feesdiscount",
            index=models.Index(
                fields=["priority"], name="fees_feesdi_priorit_d77f2c_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoice",
            index=models.Index(
                fields=["invoice_number"], name="fees_feeinv_invoice_7fcbc1_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoice",
            index=models.Index(
                fields=["student", "academic_session"],
                name="fees_feeinv_student_ac7806_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoice",
            index=models.Index(fields=["status"], name="fees_feeinv_status_5fa645_idx"),
        ),
        migrations.AddIndex(
            model_name="feeinvoice",
            index=models.Index(
                fields=["issue_date"], name="fees_feeinv_issue_d_252925_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoice",
            index=models.Index(
                fields=["due_date"], name="fees_feeinv_due_dat_9fb110_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="feeinvoice",
            index=models.Index(
                fields=["fiscal_period"], name="fees_feeinv_fiscal__55f9f4_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["payment_number"], name="fees_paymen_payment_aec243_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["student", "payment_date"],
                name="fees_paymen_student_ed705a_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["invoice"], name="fees_paymen_invoice_cdcf53_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(fields=["status"], name="fees_paymen_status_42ba84_idx"),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["payment_date"], name="fees_paymen_payment_1bd5e4_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["reference_number"], name="fees_paymen_referen_8281c1_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["transaction_id"], name="fees_paymen_transac_a509d1_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["receipt_number"], name="fees_paymen_receipt_755eab_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["academic_session"], name="fees_paymen_academi_776eef_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="payment",
            index=models.Index(
                fields=["fiscal_period"], name="fees_paymen_fiscal__3f8fff_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="refund",
            index=models.Index(
                fields=["refund_number"], name="fees_refund_refund__1f5008_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="refund",
            index=models.Index(
                fields=["student", "status"], name="fees_refund_student_d7fcc3_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="refund",
            index=models.Index(fields=["status"], name="fees_refund_status_9739a5_idx"),
        ),
        migrations.AddIndex(
            model_name="refund",
            index=models.Index(
                fields=["fiscal_period"], name="fees_refund_fiscal__cea960_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="scholarshipprogram",
            index=models.Index(fields=["code"], name="fees_schola_code_abbb4a_idx"),
        ),
        migrations.AddIndex(
            model_name="scholarshipprogram",
            index=models.Index(
                fields=["scholarship_type"], name="fees_schola_scholar_8dd413_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="scholarshipprogram",
            index=models.Index(
                fields=["is_active"], name="fees_schola_is_acti_4e333a_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="studentaccount",
            index=models.Index(fields=["status"], name="fees_studen_status_b28cff_idx"),
        ),
        migrations.AddIndex(
            model_name="studentaccount",
            index=models.Index(
                fields=["student"], name="fees_studen_student_e326a9_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="accounttransaction",
            index=models.Index(
                fields=["student_account", "-created_at"],
                name="fees_accoun_student_bcaa63_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="accounttransaction",
            index=models.Index(
                fields=["transaction_type"], name="fees_accoun_transac_53e7cb_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="accounttransaction",
            index=models.Index(
                fields=["reference_number"], name="fees_accoun_referen_28d330_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="accounttransaction",
            index=models.Index(
                fields=["academic_session"], name="fees_accoun_academi_2ea5e1_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="accounttransaction",
            index=models.Index(
                fields=["fiscal_period"], name="fees_accoun_fiscal__5cddc9_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="scholarshipapplicationlog",
            index=models.Index(
                fields=["scholarship", "invoice"], name="fees_schola_scholar_26078c_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="scholarshipapplicationlog",
            index=models.Index(
                fields=["student", "application_date"],
                name="fees_schola_student_5a6482_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="scholarshipapplicationlog",
            index=models.Index(
                fields=["is_reversed"], name="fees_schola_is_reve_1bc6c9_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="studentscholarshipapplication",
            index=models.Index(
                fields=["application_number"], name="fees_studen_applica_ac6de9_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="studentscholarshipapplication",
            index=models.Index(
                fields=["student", "status"], name="fees_studen_student_5bea9c_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="studentscholarshipapplication",
            index=models.Index(
                fields=["scholarship_program"], name="fees_studen_scholar_2efd0c_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="studentscholarshipapplication",
            index=models.Index(fields=["status"], name="fees_studen_status_29fd1a_idx"),
        ),
        migrations.AddIndex(
            model_name="studentscholarship",
            index=models.Index(
                fields=["student", "status"], name="fees_studen_student_69c7c2_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="studentscholarship",
            index=models.Index(
                fields=["scholarship_program"], name="fees_studen_scholar_ebc9fc_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="studentscholarship",
            index=models.Index(fields=["status"], name="fees_studen_status_ccb2ce_idx"),
        ),
    ]
